@use "sass:map";
@import "./pytch-mixins.scss";
@import "./pytch-variables.scss";
@import "../node_modules/bootstrap/scss/bootstrap";

$panel-background: #f4f4ff;

/*
Background colours for the various "cards": actor, appearance, sound.

TODO: Use our brand colours (from graphic designer) somehow?
*/
$stage-card-background: #262;
$sprite-card-background: #22c;

$focused-item-background-glow: lighten($primary, 25);

$ide-gap: 6px;

.abs-0000,
.abs-0000-oflow {
  position: absolute;
  left: 0px;
  right: 0px;
  top: 0px;
  bottom: 0px;
}

.abs-0000-oflow {
  overflow: auto;
}

////////////////////////////////////////////////////////////////////////

@mixin min-dimens-zero() {
  min-width: 0;
  min-height: 0;
}

@mixin grid-hstack-two($left, $right) {
  display: grid;
  grid-template-rows: 1fr;
  grid-template-columns: $left $right;
  column-gap: $ide-gap;
}

@mixin grid-vstack-two($top, $bottom) {
  display: grid;
  grid-template-columns: 1fr;
  grid-template-rows: $top $bottom;
  row-gap: $ide-gap;
}

////////////////////////////////////////////////////////////////////////

@mixin border-and-label-bg($colour) {
  border-color: $colour;
  .label {
    background-color: $colour;
  }
}

////////////////////////////////////////////////////////////////////////

.Junior-IDEContents {
  margin: $ide-gap;
  @include grid-hstack-two(1fr, auto);
}

////////////////////////////////////////////////////////////////////////

.Junior-EditorAndInfo {
  @include min-dimens-zero();
  @include grid-vstack-two(2fr, 1fr);
}

.Junior-StageAndActorsList {
  @include min-dimens-zero();
  @include grid-vstack-two(auto, 1fr);
}

////////////////////////////////////////////////////////////////////////

.Junior-ActorProperties-container {
  @include min-dimens-zero();
  @include grid-vstack-two(auto, 1fr);
  background-color: $panel-background;

  .tab-content {
    overflow: auto;
    position: relative;
  }

  .AppearancesTabTitle {
    display: grid;
    .title-option {
      grid-column: 1 / 2;
      grid-row: 1 / 2;
      visibility: hidden;
    }
    .title-option.isActive {
      visibility: visible;
    }
  }
}

.Junior-InfoPanel-container {
  @include min-dimens-zero();
  @include grid-vstack-two(auto, 1fr);
  background-color: $panel-background;

  .tab-content {
    overflow: auto;
  }
}

////////////////////////////////////////////////////////////////////////

.Junior-ActorsList-container {
  position: relative;
  background-color: $panel-background;

  .ActorsList {
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: space-evenly;
    align-content: flex-start;

    margin-top: 0.5rem;
  }
}

.Junior-CodeEditor {
  @include grid-hstack-two(auto, 1fr);
  > * {
    @include min-dimens-zero();
    overflow: auto;
  }
}

.Junior-HelpSidebarMachinery {
  &.expanded {
    @include grid-vstack-two(auto, 1fr);
  }

  // TODO: Get rid of duplication with near-identical code in
  // pytch-ide.scss.
  .control {
    @include background-color-as-button($help-sidebar-expand-button-background);
    color: white;
    height: 100%;
    width: 1.5rem;
    @include align-center-middle();
    cursor: pointer;
    user-select: none;
    p {
      margin: 0px;
    }
  }

  // TODO: Get rid of duplication with identical code in pytch-ide.scss.
  .dismiss-help {
    border-color: transparent;
    p {
      margin: 0px;
      text-align: right;
    }
  }

  .content {
    width: 23rem;
    min-height: 0;
    overflow: auto;
    .inner-content {
      margin: 1rem;
    }
  }
}

////////////////////////////////////////////////////////////////////////

.Junior-AssetsList {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  justify-content: space-evenly;
  align-content: flex-start;

  margin-top: 0.5rem;
}

////////////////////////////////////////////////////////////////////////

.AssetCard,
.ActorCard {
  cursor: pointer;
  user-select: none;
  position: relative;

  padding: 0.5rem;
  margin: 0.75rem;
  border-radius: 6px;

  background-color: transparent;

  &.isFocused {
    background-color: $focused-item-background-glow;
  }

  .dropdown {
    border-radius: 4px;

    position: absolute;
    right: 0rem;
    top: 0rem;

    button {
      padding: 0.25rem;
      font-size: 0.6667rem;
    }
  }

  .AssetCardContent,
  .ActorCardContent {
    position: relative;
    display: flex;
    flex-direction: column;
    border: 3px solid;
    border-radius: 2px;
    background-color: white;

    .label {
      padding: 0.25rem;
      font-size: 0.875rem;
      text-align: center;
      color: white;
      overflow-x: hidden;
      text-overflow: ellipsis;
      margin: 0px;

      pre {
        margin: 0px;
      }
    }
  }

  &.kind-stage .AssetCardContent,
  &.kind-stage .ActorCardContent {
    @include border-and-label-bg($stage-card-background);
  }

  &.kind-sprite .AssetCardContent,
  &.kind-sprite .ActorCardContent {
    @include border-and-label-bg($sprite-card-background);
  }

  // Specify size of different card kinds separately.
  .ActorCardContent {
    width: 7rem;
    height: 8rem;
  }

  &.ActorCard .dropdown {
    display: none;
    right: -0.5rem;
    top: -0.5rem;
  }

  &.ActorCard.isFocused .dropdown {
    display: block;
  }

  .AssetCardContent {
    width: 11rem;
    height: 11rem;
  }

  .thumbnail {
    flex-grow: 1;
    min-height: 1px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    background-color: #ddd;

    .asset-preview {
      text-align: center;
      font-size: 0.75rem;
    }
  }
}

////////////////////////////////////////////////////////////////////////

.NoContentHelp {
  margin: 2rem 3rem 1rem;
}

////////////////////////////////////////////////////////////////////////

.AddSomethingButton {
  margin-bottom: 3rem;
  display: flex;
  flex-direction: row;
  justify-content: right;

  div {
    cursor: pointer;
    user-select: none;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    width: 3.5rem;
    height: 3.5rem;
    margin: 1rem;

    @include background-color-as-button($primary);

    color: white;
    padding: 6px;
    border-radius: 50%;
    font-size: 1.5rem;
  }
}

////////////////////////////////////////////////////////////////////////

.AddSpriteModal {
  .validity-assessment {
    p {
      min-height: 3rem;
    }
    &.valid {
      visibility: hidden;
    }
  }
}

////////////////////////////////////////////////////////////////////////

.UpsertHandlerModal li .bump,
.HatBlock .bump {
  background-color: $scratch-hat-block-background;
  width: 6rem;
  height: 1.1111rem;
  transform: translateY(0.3333rem);
  border-top-left-radius: 50% 100%;
  border-top-right-radius: 50% 100%;
}

.HatBlock {
  .body {
    background-color: $scratch-hat-block-background;
    padding: 0.25rem 0rem;
    border-top-right-radius: $hat-block-TR-radius;

    display: flex;
    flex-direction: row;
    align-items: center;

    .content {
      flex-grow: 1;
      margin-left: 0.5rem;
      color: white;
    }

    .dropdown {
      margin-right: 1rem;
      button {
        padding: 0px 6px 0px 2px;
        font-size: 0.875rem;
      }
    }
  }
}

.PytchScriptEditor {
  margin: 1rem;

  .hat-code-spacer {
    height: 0.5rem;
    background-color: white;
  }
}

////////////////////////////////////////////////////////////////////////

$key-chooser-width: 54rem;

.KeyChoiceModal {
  .modal-dialog {
    max-width: $key-chooser-width;
  }

  .modal-content {
    width: $key-chooser-width;

    .keyboard {
      display: flex;
      flex-direction: column;
      .key-row {
        display: flex;
        flex-direction: row;
        justify-content: center;
      }
    }

    .KeyOption {
      margin: 0.5rem;
      font-size: 1.5rem;
      width: 3.75rem;

      &.spacebar {
        width: 12rem;
      }

      background-color: darken($secondary, 10);
      &:hover {
        background-color: darken($primary, 5);
      }
      &.isSelected {
        background-color: lighten($primary, 5);
      }
    }
  }
}

////////////////////////////////////////////////////////////////////////

.UpsertHandlerModal {
  ul {
    &:focus {
      outline: none;
    }
    list-style: none;
    padding-left: 0px;
    li {
      cursor: pointer;
      user-select: none;
      padding: 0.5rem;
      margin: 0.5rem 0rem;
      border-radius: 0.5rem 0.5rem 0rem 0rem;
      background-color: transparent;
      &.chosen {
        background-color: $focused-item-background-glow;
      }
      .content {
        border-top-right-radius: $hat-block-TR-radius;
        padding: 0.5rem;
        background-color: $scratch-hat-block-background;
        color: white;
        input {
          display: inline-block;
          height: 1.5rem;
          width: 8rem;
          margin: 0px 0.25rem;
          padding: 0px 0.125rem;
          font-family: $monospace-fonts;
        }
      }
    }
  }

  .KeyEditor {
    display: inline-block;
    margin: 0rem 0.25rem;

    span {
      display: inline-block;
      padding: 0.125rem 0.25rem;
      min-width: 2rem;
      text-align: center;
      border-radius: 6px;
    }

    span.key-button {
      background-color: $secondary;
      color: white;
      font-size: 1.125rem;
      position: relative;

      span.edit-button {
        visibility: hidden;
        @include align-center-middle();

        position: absolute;
        top: 0px;
        bottom: 0px;
        left: 0px;
        right: 0px;
        background-color: lighten($primary, 5);
        color: white;
        font-size: 0.875rem;
        cursor: pointer;
        user-select: none;
      }

      &:hover span.edit-button {
        visibility: visible;
      }
    }
  }
}
